<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>earth_size - NeoFermi Notebook</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <style>

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: #1e1e1e;
  color: #d4d4d4;
  line-height: 1.6;
  padding: 20px;
}

.neofermi-notebook {
  max-width: 800px;
  margin: 0 auto;
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  color: #ffffff;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  font-weight: 600;
}

h1 { font-size: 2em; border-bottom: 1px solid #3e3e3e; padding-bottom: 0.3em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }

p {
  margin: 1em 0;
}

a {
  color: #4ec9b0;
}

ul, ol {
  margin: 1em 0;
  padding-left: 2em;
}

blockquote {
  border-left: 4px solid #4ec9b0;
  padding-left: 1em;
  margin: 1em 0;
  color: #888;
}

/* Code blocks (non-NeoFermi) */
pre {
  background: #252525;
  border-radius: 6px;
  padding: 12px;
  overflow-x: auto;
  margin: 1em 0;
}

code {
  font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
  font-size: 0.9em;
}

p code, li code {
  background: #252525;
  padding: 2px 6px;
  border-radius: 3px;
}

/* NeoFermi cells */
.nf-cell {
  background: #252525;
  border-radius: 8px;
  margin: 1em 0;
  border: 1px solid #3e3e3e;
  overflow: hidden;
}

.nf-code {
  background: #2d2d2d;
  margin: 0;
  padding: 12px;
  border-bottom: 1px solid #3e3e3e;
  border-radius: 0;
}

.nf-code code {
  color: #ce9178;
}

.nf-result {
  padding: 12px;
  background: rgba(206, 145, 120, 0.08);
}

.nf-stats {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.nf-stat {
  font-size: 0.9em;
}

.nf-stat strong {
  color: #4ec9b0;
}

.nf-scalar {
  color: #4ec9b0;
  font-weight: 500;
}

.nf-dim {
  color: #888;
  font-style: italic;
  font-size: 0.9em;
}

.nf-error {
  padding: 12px;
  background: rgba(244, 135, 113, 0.1);
  color: #f48771;
  font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
  font-size: 0.85em;
}

.nf-viz {
  padding: 12px;
  display: flex;
  justify-content: center;
}

.nf-viz canvas {
  border-radius: 4px;
}

/* Tables */
table {
  border-collapse: collapse;
  margin: 1em 0;
  width: 100%;
}

th, td {
  border: 1px solid #3e3e3e;
  padding: 8px 12px;
  text-align: left;
}

th {
  background: #2d2d2d;
  font-weight: 600;
}

/* Horizontal rule */
hr {
  border: none;
  border-top: 1px solid #3e3e3e;
  margin: 2em 0;
}

/* Images */
img {
  max-width: 100%;
  border-radius: 4px;
}

  </style>
</head>
<body>
  <article class="neofermi-notebook">
<h1>Estimating the Earth's Circumference</h1>
<p>A classic Fermi estimation using what we know about time zones and the United States.</p>
<h2>What We Know</h2>
<p>The Earth has 24 time zones (one for each hour). The continental US spans about 4 of these time zones (Eastern, Central, Mountain, Pacific). And we roughly know how wide the US is.</p>
<h2>The Estimation</h2>
<h3>US Width</h3>
<p>The continental US is roughly 2000-3000 miles wide:</p>
<div class="nf-cell">
<pre class="nf-code"><code>us_width = 2000 to 3000 mile</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>2503</strong> mile <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 2454 mile</span>
<span class="nf-stat">[68% CI]: [2003, 3004] mile</span>
</div></div><div class="nf-viz" data-samples="[1653.9936509592362,1833.8003104611148,1938.6144305431917,2029.0367524860767,2101.782888223932,2168.0252543207166,2231.9042567727547,2293.007911860768,2356.412292282484,2421.004995592082,2486.737032690404,2553.6724157624813,2617.9543587981825,2692.9291810937243,2772.5152575053276,2859.90722044399,2965.613893971408,3101.5201665380255,3280.038119675877,3634.6237193755983]" data-unit="mile" data-min="1120.427233622841" data-max="5480.5855000671345"></div>
</div>
<h3>Time Zone Width</h3>
<p>The US spans about 4 time zones, so each time zone is:</p>
<div class="nf-cell">
<pre class="nf-code"><code>us_timezones = 3 to 5
timezone_width = us_width / us_timezones</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>668</strong> mile <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 636 mile</span>
<span class="nf-stat">[68% CI]: [457, 876] mile</span>
</div></div><div class="nf-viz" data-samples="[333.9012765414756,394.6117371692419,434.3641162490414,466.0106978704788,494.8482988512386,522.098784134018,547.8103271048624,573.0404722981228,597.0528538719764,623.1990561053578,648.4521128916613,675.4263457488022,703.4480696956022,734.4595916897956,769.1218954977052,808.9047842147252,856.9803868650384,922.5058957122479,1009.1312420332125,1188.0740840479898]" data-unit="mile" data-min="176.6232761982246" data-max="2484.9958971310207"></div>
</div>
<h3>Earth's Circumference</h3>
<p>With 24 time zones around the Earth:</p>
<div class="nf-cell">
<pre class="nf-code"><code>num_timezones = 24
earth_circumference = timezone_width * num_timezones</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>16023</strong> mile <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 15254 mile</span>
<span class="nf-stat">[68% CI]: [10974, 21022] mile</span>
</div></div><div class="nf-viz" data-samples="[8013.6306369954145,9470.681692061806,10424.738789976993,11184.25674889149,11876.359172429726,12530.370819216434,13147.447850516697,13752.971335154947,14329.268492927433,14956.777346528588,15562.85070939987,16210.232297971252,16882.753672694453,17627.030200555095,18458.925491944923,19413.714821153404,20567.529284760923,22140.14149709395,24219.1498087971,28513.778017151755]" data-unit="mile" data-min="4238.95862875739" data-max="59639.9015311445"></div>
</div>
<h3>Convert to Kilometers</h3>
<div class="nf-cell">
<pre class="nf-code"><code>earth_circumference_km = earth_circumference as km</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>25787</strong> km <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 24549 km</span>
<span class="nf-stat">[68% CI]: [17661, 33832] km</span>
</div></div><div class="nf-viz" data-samples="[12896.68838386475,15241.584757029515,16776.990823216736,17999.316493288028,19113.147375994748,20165.677095681054,21158.766313541946,22133.261900403606,23060.72227348181,24070.599881971706,25045.980412068428,26087.84008734625,27170.15832662878,28367.95529108214,29706.76098690861,31243.345465134305,33100.22984925428,35631.10387749917,38976.943429888765,45888.477569235074]" data-unit="km" data-min="6821.942635438934" data-max="95981.11768973821"></div>
</div>
<h2>Result</h2>
<p>The Earth's circumference is approximately <strong>16023 mile</strong> or <strong>25787 km</strong>.</p>
<p>The actual value is about 24,901 miles (40,075 km) - let's see how close our estimate is!</p>
  </article>
  <script type="module">

// Nice number for tick marks (1, 2, 5, 10, 20, 50, etc.)
function niceNum(x, round) {
  if (x === 0) return 0;
  const exp = Math.floor(Math.log10(Math.abs(x)));
  const f = x / Math.pow(10, exp);
  let nf;
  if (round) {
    nf = f < 1.5 ? 1 : f < 3 ? 2 : f < 7 ? 5 : 10;
  } else {
    nf = f <= 1 ? 1 : f <= 2 ? 2 : f <= 5 ? 5 : 10;
  }
  return nf * Math.pow(10, exp);
}

function generateLinearTicks(min, max, maxTicks = 5) {
  const range = niceNum(max - min, false);
  const spacing = niceNum(range / (maxTicks - 1), true);
  const niceMin = Math.floor(min / spacing) * spacing;
  const niceMax = Math.ceil(max / spacing) * spacing;
  const ticks = [];
  for (let t = niceMin; t <= niceMax + spacing * 0.5; t += spacing) {
    if (t >= min && t <= max) ticks.push(t);
  }
  return ticks;
}

function generateLogTicks(min, max) {
  if (min <= 0 || max <= 0) return [];
  const minExp = Math.floor(Math.log10(min));
  const maxExp = Math.ceil(Math.log10(max));
  const ticks = [];
  for (let exp = minExp; exp <= maxExp; exp++) {
    const tick = Math.pow(10, exp);
    if (tick >= min * 0.99 && tick <= max * 1.01) ticks.push(tick);
  }
  if (ticks.length <= 2) {
    const allTicks = [];
    for (let exp = minExp; exp <= maxExp; exp++) {
      for (const mult of [1, 2, 5]) {
        const tick = mult * Math.pow(10, exp);
        if (tick >= min * 0.99 && tick <= max * 1.01) allTicks.push(tick);
      }
    }
    return allTicks;
  }
  return ticks;
}

function formatNum(n) {
  if (n === 0) return '0';
  const abs = Math.abs(n);
  if (abs >= 10000 || abs < 0.001) return n.toExponential(0);
  if (Math.abs(n - Math.round(n)) < 0.001) return Math.round(n).toString();
  if (abs >= 100) return n.toFixed(0);
  if (abs >= 10) return n.toFixed(1);
  if (abs >= 1) return n.toFixed(2);
  return n.toPrecision(2);
}

function renderDotplots() {
  document.querySelectorAll('.nf-viz').forEach(el => {
    const samples = JSON.parse(el.dataset.samples || '[]');
    const unit = el.dataset.unit || '';
    const min = parseFloat(el.dataset.min);
    const max = parseFloat(el.dataset.max);

    if (samples.length === 0) return;

    const dpr = window.devicePixelRatio || 1;
    const displayWidth = 280;
    const displayHeight = 90;

    const canvas = document.createElement('canvas');
    canvas.width = displayWidth * dpr;
    canvas.height = displayHeight * dpr;
    canvas.style.width = displayWidth + 'px';
    canvas.style.height = displayHeight + 'px';
    el.appendChild(canvas);

    const ctx = canvas.getContext('2d');
    ctx.scale(dpr, dpr);

    const width = displayWidth;
    const height = displayHeight;
    const dotRadius = 5;
    const padding = 25;
    const axisHeight = 20;

    // Background
    ctx.fillStyle = '#1a1a2e';
    ctx.fillRect(0, 0, width, height);

    const useLog = min > 0 && max > 0 && (max / min) > 100;
    const toX = useLog
      ? v => padding + ((Math.log10(v) - Math.log10(min)) / (Math.log10(max) - Math.log10(min))) * (width - 2 * padding)
      : v => padding + ((v - min) / (max - min)) * (width - 2 * padding);

    // Generate nice ticks
    const ticks = useLog ? generateLogTicks(min, max) : generateLinearTicks(min, max, 5);

    // Bin dots by X position to stack them vertically
    const binWidth = dotRadius * 2.2;
    const bins = new Map();
    samples.forEach(v => {
      const x = toX(v);
      const binIndex = Math.round(x / binWidth);
      if (!bins.has(binIndex)) bins.set(binIndex, []);
      bins.get(binIndex).push(v);
    });

    // Draw stacked dots from bottom up, all dots in a bin share the same X
    const baseY = height - axisHeight - dotRadius - 2;
    ctx.fillStyle = 'rgba(99, 102, 241, 0.85)';
    bins.forEach((dots, binIndex) => {
      const x = binIndex * binWidth; // Use bin center, not individual x
      dots.forEach((v, i) => {
        const y = baseY - i * (dotRadius * 2.2);
        if (y > dotRadius) {
          ctx.beginPath();
          ctx.arc(x, y, dotRadius, 0, Math.PI * 2);
          ctx.fill();
        }
      });
    });

    // Draw axis line
    const axisY = height - axisHeight;
    ctx.strokeStyle = '#555';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(padding, axisY);
    ctx.lineTo(width - padding, axisY);
    ctx.stroke();

    // Draw ticks and labels
    ctx.fillStyle = '#999';
    ctx.font = '10px -apple-system, sans-serif';
    ctx.textAlign = 'center';
    ticks.forEach(tick => {
      const x = toX(tick);
      // Tick mark
      ctx.beginPath();
      ctx.moveTo(x, axisY);
      ctx.lineTo(x, axisY + 4);
      ctx.stroke();
      // Label
      ctx.fillText(formatNum(tick), x, axisY + 14);
    });

    // Unit label on right
    if (unit) {
      ctx.fillStyle = '#777';
      ctx.textAlign = 'right';
      ctx.fillText(unit, width - 5, axisY + 14);
    }
  });
}

renderDotplots();

  </script>
</body>
</html>