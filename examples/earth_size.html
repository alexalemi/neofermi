<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>earth_size - NeoFermi Notebook</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <style>

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: #1e1e1e;
  color: #d4d4d4;
  line-height: 1.6;
  padding: 20px;
}

.neofermi-notebook {
  max-width: 800px;
  margin: 0 auto;
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  color: #ffffff;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  font-weight: 600;
}

h1 { font-size: 2em; border-bottom: 1px solid #3e3e3e; padding-bottom: 0.3em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.25em; }

p {
  margin: 1em 0;
}

a {
  color: #4ec9b0;
}

ul, ol {
  margin: 1em 0;
  padding-left: 2em;
}

blockquote {
  border-left: 4px solid #4ec9b0;
  padding-left: 1em;
  margin: 1em 0;
  color: #888;
}

/* Code blocks (non-NeoFermi) */
pre {
  background: #252525;
  border-radius: 6px;
  padding: 12px;
  overflow-x: auto;
  margin: 1em 0;
}

code {
  font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
  font-size: 0.9em;
}

p code, li code {
  background: #252525;
  padding: 2px 6px;
  border-radius: 3px;
}

/* NeoFermi cells */
.nf-cell {
  background: #252525;
  border-radius: 8px;
  margin: 1em 0;
  border: 1px solid #3e3e3e;
  overflow: hidden;
}

.nf-code {
  background: #2d2d2d;
  margin: 0;
  padding: 12px;
  border-bottom: 1px solid #3e3e3e;
  border-radius: 0;
}

.nf-code code {
  color: #ce9178;
}

.nf-result {
  padding: 12px;
  background: rgba(206, 145, 120, 0.08);
}

.nf-stats {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.nf-stat {
  font-size: 0.9em;
}

.nf-stat strong {
  color: #4ec9b0;
}

.nf-scalar {
  color: #4ec9b0;
  font-weight: 500;
}

.nf-dim {
  color: #888;
  font-style: italic;
  font-size: 0.9em;
}

.nf-error {
  padding: 12px;
  background: rgba(244, 135, 113, 0.1);
  color: #f48771;
  font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
  font-size: 0.85em;
}

.nf-viz {
  padding: 12px;
  display: flex;
  justify-content: center;
}

.nf-viz canvas {
  border-radius: 4px;
}

/* Tables */
table {
  border-collapse: collapse;
  margin: 1em 0;
  width: 100%;
}

th, td {
  border: 1px solid #3e3e3e;
  padding: 8px 12px;
  text-align: left;
}

th {
  background: #2d2d2d;
  font-weight: 600;
}

/* Horizontal rule */
hr {
  border: none;
  border-top: 1px solid #3e3e3e;
  margin: 2em 0;
}

/* Images */
img {
  max-width: 100%;
  border-radius: 4px;
}

  </style>
</head>
<body>
  <article class="neofermi-notebook">
<h1>Estimating the Earth's Circumference</h1>
<p>A classic Fermi estimation using what we know about time zones and the United States.</p>
<h2>What We Know</h2>
<p>The Earth has 24 time zones (one for each hour). The continental US spans about 4 of these time zones (Eastern, Central, Mountain, Pacific). And we roughly know how wide the US is.</p>
<h2>The Estimation</h2>
<h3>US Width</h3>
<p>The continental US is roughly 2000-3000 miles wide:</p>
<div class="nf-cell">
<pre class="nf-code"><code>mile = 5280 feet
us_width = 2000 to 3000 mile</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>2495</strong> mile <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 2444 mile</span>
<span class="nf-stat">[68% CI]: [2002, 2984] mile</span>
</div></div><div class="nf-viz" data-samples="[1650.804978739356,1830.9827980878395,1936.7668763874196,2024.9249973031476,2098.3381745823713,2168.7951238815112,2232.232456546483,2295.6362100963215,2355.4587785181284,2414.050161029404,2476.055467907355,2539.7965478322735,2606.137664741995,2676.42997903989,2757.708588747991,2846.0397929621836,2948.2663119124027,3078.454325712577,3266.3095412786647,3628.443773976177]" data-unit="mile" data-min="1190.238663087648" data-max="5945.033486436152"></div>
</div>
<h3>Time Zone Width</h3>
<p>The US spans about 4 time zones, so each time zone is:</p>
<div class="nf-cell">
<pre class="nf-code"><code>us_timezones = 3 to 5
timezone_width = us_width / us_timezones</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>666</strong> mile <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 630 mile</span>
<span class="nf-stat">[68% CI]: [458, 872] mile</span>
</div></div><div class="nf-viz" data-samples="[336.71068150860225,397.1310131823136,435.7324085735759,466.3605632672452,493.4448647703299,519.5632398125015,544.7228449259682,569.5350080398506,593.9343882905118,617.7317522214464,644.5214572036707,671.490088493622,701.2152254858827,733.3234053755325,769.7141908481992,808.3136015331272,856.8204795732628,918.9632187375547,1003.7134432782318,1198.9429176406804]" data-unit="mile" data-min="179.2395467081724" data-max="2120.575445067982"></div>
</div>
<h3>Earth's Circumference</h3>
<p>With 24 time zones around the Earth:</p>
<div class="nf-cell">
<pre class="nf-code"><code>num_timezones = 24
earth_circumference = timezone_width * num_timezones</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>15982</strong> mile <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 15124 mile</span>
<span class="nf-stat">[68% CI]: [10984, 20938] mile</span>
</div></div><div class="nf-viz" data-samples="[8081.056356206454,9531.144316375527,10457.577805765823,11192.653518413885,11842.676754487919,12469.517755500035,13073.348278223235,13668.840192956413,14254.425318972284,14825.562053314714,15468.514972888097,16115.76212384693,16829.165411661183,17599.761729012782,18473.140580356783,19399.52643679505,20563.691509758308,22055.117249701314,24089.122638677563,28774.630023376332]" data-unit="mile" data-min="4301.749120996138" data-max="50893.81068163157"></div>
</div>
<h3>Convert to Kilometers</h3>
<div class="nf-cell">
<pre class="nf-code"><code>earth_circumference_km = earth_circumference / mile * (1.6 km)</code></pre>
<div class="nf-result"><div class="nf-stats">
<span class="nf-stat">Mean: <strong>4.84</strong> (mile km) / feet <span class="nf-dim">{length}</span></span>
<span class="nf-stat">Median: 4.58 (mile km) / feet</span>
<span class="nf-stat">[68% CI]: [3.33, 6.34] (mile km) / feet</span>
</div></div><div class="nf-viz" data-samples="[2.4488049564261987,2.8882255504168266,3.1689629714441887,3.391713187398147,3.5886899256023996,3.77864174409092,3.961620690370678,4.142072785744368,4.319522823930995,4.492594561610519,4.68742877966306,4.883564279953615,5.099747094442783,5.333261130003874,5.597921387986904,5.878644374786379,6.23142166962373,6.683368863545853,7.2997341329325955,8.719584855568586]" data-unit="(mile km) / feet" data-min="1.3035603396957995" data-max="15.422366873221689"></div>
</div>
<h2>Result</h2>
<p>The Earth's circumference is approximately <strong>15982 mile</strong> or <strong>4.84 (mile km) / feet</strong>.</p>
<p>The actual value is about 24,901 miles (40,075 km) - let's see how close our estimate is!</p>
  </article>
  <script type="module">

// Nice number for tick marks (1, 2, 5, 10, 20, 50, etc.)
function niceNum(x, round) {
  if (x === 0) return 0;
  const exp = Math.floor(Math.log10(Math.abs(x)));
  const f = x / Math.pow(10, exp);
  let nf;
  if (round) {
    nf = f < 1.5 ? 1 : f < 3 ? 2 : f < 7 ? 5 : 10;
  } else {
    nf = f <= 1 ? 1 : f <= 2 ? 2 : f <= 5 ? 5 : 10;
  }
  return nf * Math.pow(10, exp);
}

function generateLinearTicks(min, max, maxTicks = 5) {
  const range = niceNum(max - min, false);
  const spacing = niceNum(range / (maxTicks - 1), true);
  const niceMin = Math.floor(min / spacing) * spacing;
  const niceMax = Math.ceil(max / spacing) * spacing;
  const ticks = [];
  for (let t = niceMin; t <= niceMax + spacing * 0.5; t += spacing) {
    if (t >= min && t <= max) ticks.push(t);
  }
  return ticks;
}

function generateLogTicks(min, max) {
  if (min <= 0 || max <= 0) return [];
  const minExp = Math.floor(Math.log10(min));
  const maxExp = Math.ceil(Math.log10(max));
  const ticks = [];
  for (let exp = minExp; exp <= maxExp; exp++) {
    const tick = Math.pow(10, exp);
    if (tick >= min * 0.99 && tick <= max * 1.01) ticks.push(tick);
  }
  if (ticks.length <= 2) {
    const allTicks = [];
    for (let exp = minExp; exp <= maxExp; exp++) {
      for (const mult of [1, 2, 5]) {
        const tick = mult * Math.pow(10, exp);
        if (tick >= min * 0.99 && tick <= max * 1.01) allTicks.push(tick);
      }
    }
    return allTicks;
  }
  return ticks;
}

function formatNum(n) {
  if (n === 0) return '0';
  const abs = Math.abs(n);
  if (abs >= 10000 || abs < 0.001) return n.toExponential(0);
  if (Math.abs(n - Math.round(n)) < 0.001) return Math.round(n).toString();
  if (abs >= 100) return n.toFixed(0);
  if (abs >= 10) return n.toFixed(1);
  if (abs >= 1) return n.toFixed(2);
  return n.toPrecision(2);
}

function renderDotplots() {
  document.querySelectorAll('.nf-viz').forEach(el => {
    const samples = JSON.parse(el.dataset.samples || '[]');
    const unit = el.dataset.unit || '';
    const min = parseFloat(el.dataset.min);
    const max = parseFloat(el.dataset.max);

    if (samples.length === 0) return;

    const dpr = window.devicePixelRatio || 1;
    const displayWidth = 280;
    const displayHeight = 90;

    const canvas = document.createElement('canvas');
    canvas.width = displayWidth * dpr;
    canvas.height = displayHeight * dpr;
    canvas.style.width = displayWidth + 'px';
    canvas.style.height = displayHeight + 'px';
    el.appendChild(canvas);

    const ctx = canvas.getContext('2d');
    ctx.scale(dpr, dpr);

    const width = displayWidth;
    const height = displayHeight;
    const dotRadius = 5;
    const padding = 25;
    const axisHeight = 20;

    // Background
    ctx.fillStyle = '#1a1a2e';
    ctx.fillRect(0, 0, width, height);

    const useLog = min > 0 && max > 0 && (max / min) > 100;
    const toX = useLog
      ? v => padding + ((Math.log10(v) - Math.log10(min)) / (Math.log10(max) - Math.log10(min))) * (width - 2 * padding)
      : v => padding + ((v - min) / (max - min)) * (width - 2 * padding);

    // Generate nice ticks
    const ticks = useLog ? generateLogTicks(min, max) : generateLinearTicks(min, max, 5);

    // Bin dots by X position to stack them
    const binWidth = dotRadius * 2.2;
    const bins = new Map();
    samples.forEach(v => {
      const x = toX(v);
      const binIndex = Math.round(x / binWidth);
      if (!bins.has(binIndex)) bins.set(binIndex, []);
      bins.get(binIndex).push({ x, v });
    });

    // Draw stacked dots from bottom up
    const baseY = height - axisHeight - dotRadius - 2;
    ctx.fillStyle = 'rgba(99, 102, 241, 0.85)';
    bins.forEach(dots => {
      dots.forEach((dot, i) => {
        const y = baseY - i * (dotRadius * 2.2);
        if (y > dotRadius) {
          ctx.beginPath();
          ctx.arc(dot.x, y, dotRadius, 0, Math.PI * 2);
          ctx.fill();
        }
      });
    });

    // Draw axis line
    const axisY = height - axisHeight;
    ctx.strokeStyle = '#555';
    ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(padding, axisY);
    ctx.lineTo(width - padding, axisY);
    ctx.stroke();

    // Draw ticks and labels
    ctx.fillStyle = '#999';
    ctx.font = '10px -apple-system, sans-serif';
    ctx.textAlign = 'center';
    ticks.forEach(tick => {
      const x = toX(tick);
      // Tick mark
      ctx.beginPath();
      ctx.moveTo(x, axisY);
      ctx.lineTo(x, axisY + 4);
      ctx.stroke();
      // Label
      ctx.fillText(formatNum(tick), x, axisY + 14);
    });

    // Unit label on right
    if (unit) {
      ctx.fillStyle = '#777';
      ctx.textAlign = 'right';
      ctx.fillText(unit, width - 5, axisY + 14);
    }
  });
}

renderDotplots();

  </script>
</body>
</html>